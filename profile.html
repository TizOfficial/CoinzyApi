<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dein Profil</title>
</head>
<body>
    <h1>Willkommen, <span id="username"></span>!</h1>
    <img id="avatar" src="" alt="Profilbild" width="128">
    <p>Deine Discord ID: <span id="userid"></span></p>
    <button onclick="logout()">Logout</button>

    <script>
        async function loadProfile() {
            const urlParams = new URLSearchParams(window.location.search);
            const userId = urlParams.get("user");

            if (!userId) {
                document.body.innerHTML = "<h1>Fehler: Kein Benutzer gefunden!</h1>";
                return;
            }

            const response = await fetch(`/api/profile.js?user=${userId}`);
            const data = await response.json();

            if (data.error) {
                document.body.innerHTML = `<h1>${data.error}</h1>`;
                return;
            }

            document.getElementById("username").textContent = data.username;
            document.getElementById("userid").textContent = data.id;
            document.getElementById("avatar").src = `https://cdn.discordapp.com/avatars/${data.id}/${data.avatar}.png?size=128`;
        }

        function logout() {
            window.location.href = "/logout";
        }

        loadProfile();
    </script>
</body>
</html>
